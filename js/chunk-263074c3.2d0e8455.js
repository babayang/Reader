(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-263074c3"],{"047b":function(t,e,i){},"0908":function(t,e,i){"use strict";i("f03c")},1432:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"detail-title-wrapper",class:{"hide-shadow":t.ifHideShadow}},[i("div",{staticClass:"title-left-wrapper",on:{click:t.back}},[i("span",{staticClass:"icon-back"})]),i("div",{staticClass:"title-right-wrapper"},[t.showShelf?i("span",{staticClass:"icon-shelf icon",on:{click:t.showBookShelf}}):i("span",{staticClass:"icon-share"})]),t.title?i("div",{staticClass:"title-text"},[t._v(" "+t._s(t.title)+" ")]):t._e()])},o=[],s={props:{title:String,showShelf:{type:Boolean,default:!0}},data:function(){return{ifHideShadow:!0}},methods:{showBookShelf:function(){this.$router.push("/store/shelf")},showShadow:function(){this.ifHideShadow=!1},hideShadow:function(){this.ifHideShadow=!0},back:function(){this.$emit("back")}}},n=s,r=(i("db58"),i("2877")),c=Object(r["a"])(n,a,o,!1,null,"20ab58c1",null);e["a"]=c.exports},"25f0":function(t,e,i){"use strict";var a=i("6eeb"),o=i("825a"),s=i("d039"),n=i("ad6d"),r="toString",c=RegExp.prototype,l=c[r],d=s((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),u=l.name!=r;(d||u)&&a(RegExp.prototype,r,(function(){var t=o(this),e=String(t.source),i=t.flags,a=String(void 0===i&&t instanceof RegExp&&!("flags"in c)?n.call(t):i);return"/"+e+"/"+a}),{unsafe:!0})},"2ca0":function(t,e,i){"use strict";var a=i("23e7"),o=i("06cf").f,s=i("50c4"),n=i("5a34"),r=i("1d80"),c=i("ab13"),l=i("c430"),d="".startsWith,u=Math.min,f=c("startsWith"),h=!l&&!f&&!!function(){var t=o(String.prototype,"startsWith");return t&&!t.writable}();a({target:"String",proto:!0,forced:!h&&!f},{startsWith:function(t){var e=String(r(this));n(t);var i=s(u(arguments.length>1?arguments[1]:void 0,e.length)),a=String(t);return d?d.call(e,a,i):e.slice(i,i+a.length)===a}})},"48e0":function(t,e,i){},"4d63":function(t,e,i){var a=i("83ab"),o=i("da84"),s=i("94ca"),n=i("7156"),r=i("9bf2").f,c=i("241c").f,l=i("44e7"),d=i("ad6d"),u=i("9f7f"),f=i("6eeb"),h=i("d039"),p=i("69f3").enforce,v=i("2626"),b=i("b622"),g=b("match"),m=o.RegExp,k=m.prototype,w=/a/g,_=/a/g,C=new m(w)!==w,S=u.UNSUPPORTED_Y,y=a&&s("RegExp",!C||S||h((function(){return _[g]=!1,m(w)!=w||m(_)==_||"/a/i"!=m(w,"i")})));if(y){var x=function(t,e){var i,a=this instanceof x,o=l(t),s=void 0===e;if(!a&&o&&t.constructor===x&&s)return t;C?o&&!s&&(t=t.source):t instanceof x&&(s&&(e=d.call(t)),t=t.source),S&&(i=!!e&&e.indexOf("y")>-1,i&&(e=e.replace(/y/g,"")));var r=n(C?new m(t,e):m(t,e),a?this:k,x);if(S&&i){var c=p(r);c.sticky=!0}return r},$=function(t){t in x||r(x,t,{configurable:!0,get:function(){return m[t]},set:function(e){m[t]=e}})},N=c(m),T=0;while(N.length>T)$(N[T++]);k.constructor=x,x.prototype=k,f(o,"RegExp",x)}v("RegExp")},"5a34":function(t,e,i){var a=i("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},"5bab":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-detail"},[i("detail-title",{ref:"title",attrs:{showShelf:!0},on:{back:t.back}}),i("scroll",{ref:"scroll",staticClass:"content-wrapper",attrs:{top:42,bottom:52},on:{onScroll:t.onScroll}},[i("book-info",{attrs:{cover:t.cover,title:t.title,author:t.author,desc:t.desc}}),i("div",{staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-title"},[t._v(" "+t._s(t.$t("detail.copyright"))+" ")]),i("div",{staticClass:"book-detail-content-list-wrapper"},[i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(" "+t._s(t.$t("detail.publisher"))+" ")]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.publisher))])]),i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(" "+t._s(t.$t("detail.category"))+" ")]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.categoryText))])]),i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.lang")))]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.lang))])]),i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.ISBN")))]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.isbn))])])])]),i("div",{staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-title"},[t._v(" "+t._s(t.$t("detail.navigation"))+" ")]),i("div",{staticClass:"book-detail-content-list-wrapper"},[this.navigation?t._e():i("div",{staticClass:"loading-text-wrapper"},[i("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])]),i("div",{staticClass:"book-detail-content-item-wrapper"},t._l(t.flatNavigation,(function(e,a){return i("div",{key:a,staticClass:"book-detail-content-item",on:{click:function(i){return t.read(e)}}},[e.label?i("div",{staticClass:"book-detail-content-navigation-text",class:{"is-sub":e.deep>1},style:t.itemStyle(e)},[t._v(" "+t._s(e.label)+" ")]):t._e()])})),0)])]),i("div",{staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.trial")))]),i("div",{staticClass:"book-detail-content-list-wrapper"},[this.displayed?t._e():i("div",{staticClass:"loading-text-wrapper"},[i("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:this.displayed,expression:"this.displayed"}],ref:"preview",attrs:{id:"preview"}})])],1),i("div",{staticClass:"bottom-wrapper"},[i("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.readBook()}}},[t._v(" "+t._s(t.$t("detail.read"))+" ")]),i("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.trialListening()}}},[t._v(" "+t._s(t.$t("detail.listen"))+" ")]),i("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addOrRemoveShelf()}}},[t.inBookShelf?i("span",{staticClass:"icon-check"}):t._e(),t._v(" "+t._s(t.inBookShelf?t.$t("detail.isAddedToShelf"):t.$t("detail.addOrRemoveShelf"))+" ")])]),i("toast",{ref:"toast",attrs:{text:t.toastText}})],1)},o=[],s=i("70e8"),n=s["a"],r=(i("0908"),i("2877")),c=Object(r["a"])(n,a,o,!1,null,"70c84f01",null);e["default"]=c.exports},6701:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper",class:{"no-scroll":t.ifNoScroll},on:{"&scroll":function(e){return t.handleScroll(e)}}},[t._t("default")],2)},o=[],s=(i("a9e3"),i("fa7d")),n={props:{top:{type:Number,default:0},bottom:{type:Number,default:0},ifNoScroll:{type:Boolean,default:!1}},methods:{handleScroll:function(t){var e=t.target.scrollTop||window.pageYOffset||document.body.scrollTop;this.$emit("onScroll",e)},scrollTo:function(t,e){this.$refs.scrollWrapper.scrollTo(t,e)},refresh:function(){this.$refs.scrollWrapper&&(this.$refs.scrollWrapper.style.height=window.innerHeight-Object(s["b"])(this.top)-Object(s["b"])(this.bottom)+"px",this.$refs.scrollWrapper.addEventListener("scroll",this.handleScroll))}},data:function(){return{}},mounted:function(){this.refresh()}},r=n,c=(i("7d60"),i("2877")),l=Object(c["a"])(r,a,o,!1,null,"709ce4b1",null);e["a"]=l.exports},"70e8":function(t,e,i){"use strict";(function(t){var a=i("2909"),o=(i("a4d3"),i("e01a"),i("99af"),i("4de4"),i("d81d"),i("159b"),i("4d63"),i("ac1f"),i("25f0"),i("5319"),i("2ca0"),i("1432")),s=i("c470"),n=i("6701"),r=i("78dc"),c=i("73f5"),l=i("fa7d"),d=i("a211"),u=i("ac0d"),f=i("e8ec"),h=i("da6f");t.ePub=d["a"],e["a"]={mixins:[u["c"]],components:{DetailTitle:o["a"],Scroll:n["a"],BookInfo:s["a"],Toast:r["a"]},computed:{desc:function(){return this.description?this.description.substring(0,100):""},flatNavigation:function(){return this.navigation?Array.prototype.concat.apply([],Array.prototype.concat.apply([],this.doFlatNavigation(this.navigation.toc))):[]},lang:function(){return this.metadata?this.metadata.language:"-"},isbn:function(){return this.metadata?this.metadata.identifier:"-"},publisher:function(){return this.metadata?this.metadata.publisher:"-"},title:function(){return this.metadata?this.metadata.title:""},author:function(){return this.metadata?this.metadata.creator:""},inBookShelf:function(){var t=this;if(this.bookItem&&this.shelfList){var e=function t(e){var i;return(i=[]).concat.apply(i,Object(a["a"])(e.map((function(e){return e.itemList?[e].concat(Object(a["a"])(t(e.itemList))):e}))))}(this.shelfList).filter((function(t){return 1===t.type})),i=e.filter((function(e){return e.fileName===t.bookItem.fileName}));return i&&i.length>0}return!1}},data:function(){return{bookItem:null,book:null,metadata:null,trialRead:null,cover:null,navigation:null,displayed:!1,audio:null,randomLocation:null,description:null,toastText:"",trialText:null,categoryText:null,opf:null}},methods:{addOrRemoveShelf:function(){var t=this;this.inBookShelf?this.setShelfList(Object(h["k"])(this.bookItem)).then((function(){Object(f["l"])(t.shelfList)})):(Object(h["a"])(this.bookItem),this.setShelfList(Object(f["c"])()))},showToast:function(t){this.toastText=t,this.$refs.toast.show()},readBook:function(){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},trialListening:function(){},read:function(t){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},itemStyle:function(t){return{marginLeft:(t.deep-1)*Object(l["a"])(20)+"rem"}},doFlatNavigation:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=[];return t.forEach((function(t){t.deep=i,a.push(t),t.subitems&&t.subitems.length>0&&a.push(e.doFlatNavigation(t.subitems,i+1))})),a},downloadBook:function(){var t="".concat("http://47.99.166.157/epub","/").concat(this.bookItem.categoryText,"/").concat(this.bookItem.fileName,"/OEBPS/package.opf");this.parseBook(t)},parseBook:function(t){var e=this;this.book=new d["a"](t),this.book.loaded.metadata.then((function(t){e.metadata=t})),this.book.loaded.navigation.then((function(t){if(e.navigation=t,e.navigation.toc&&e.navigation.toc.length>1){var i=e.display(e.navigation.toc[1].href);i&&i.then((function(t){e.$refs.scroll&&e.$refs.scroll.refresh(),e.displayed=!0;var i=new RegExp("<.+?>","g"),a=t.output.replace(i,"").replace(/\s\s/g,"");e.description=a}))}}))},init:function(){var t=this;this.fileName=this.$route.query.fileName,this.categoryText=this.$route.query.category,this.fileName&&Object(c["a"])({fileName:this.fileName}).then((function(e){if(200===e.status&&0===e.data.error_code&&e.data.data){var i=e.data.data;t.bookItem=i,t.cover=t.bookItem.cover;var a=i.rootFile;a.startsWith("/")&&(a=a.substring(1,a.length)),t.opf="".concat("http://47.99.166.157/epub2","/").concat(t.fileName,"/").concat(a),t.parseBook(t.opf)}else t.showToast(e.data.msg)}))},back:function(){this.$router.go(-1)},display:function(t){if(this.$refs.preview)return this.rendition||(this.rendition=this.book.renderTo("preview",{width:window.innerWidth>640?640:window.innerWidth,height:window.innerHeight,method:"default"})),t?this.rendition.display(t):this.rendition.display()},onScroll:function(t){t>Object(l["b"])(42)?this.$refs.title.showShadow():this.$refs.title.hideShadow()}},mounted:function(){this.init(),this.shelfList&&0!==this.shelfList.length||this.getShelfList()}}}).call(this,i("c8ba"))},"7d60":function(t,e,i){"use strict";i("047b")},ab13:function(t,e,i){var a=i("b622"),o=a("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[o]=!1,"/./"[t](e)}catch(a){}}return!1}},b011:function(t,e,i){},b55a:function(t,e,i){"use strict";i("48e0")},c470:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cover-title-wrapper"},[i("div",{staticClass:"cover-title-left-wrapper"},[i("img",{staticClass:"cover-img",attrs:{src:t.cover}})]),i("div",{staticClass:"cover-title-right-wrapper"},[i("div",{staticClass:"detail-cover-title-wrapper"},[i("div",{staticClass:"cover-title-text"},[t._v(t._s(t.title))])]),i("div",{staticClass:"cover-author-wrapper"},[i("div",{staticClass:"cover-author-text"},[t._v(t._s(t.author))])]),i("div",{staticClass:"detail-cover-description-wrapper"},[i("div",{staticClass:"detail-cover-description-text"},[t._v(t._s(t.desc))])])])])},o=[],s={props:{cover:String,title:String,author:String,desc:String}},n=s,r=(i("b55a"),i("2877")),c=Object(r["a"])(n,a,o,!1,null,"395bbb7d",null);e["a"]=c.exports},db58:function(t,e,i){"use strict";i("b011")},f03c:function(t,e,i){}}]);
//# sourceMappingURL=chunk-263074c3.2d0e8455.js.map